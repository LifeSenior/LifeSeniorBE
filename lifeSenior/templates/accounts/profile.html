{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lifesenior</title>
    <link rel="stylesheet" href="{% static 'css/profileStyle.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
</head>
<body>
    <!-- nav bar -->
    <!-- copy -->
    <nav>
        <div class="nav-left">
            <img src="{% static 'img/main-nav-logo.png' %}" alt="로고">
            <a href="{% url 'main' %}" style=" color: #95969D;" >홈</a>
            <a class="nav-second" style="color: #95969D;" href="{% url 'quizApp:studySpace' level=0 %}">오늘의 공부</a>
            <a class="nav-third"href="{% url 'communicationApp:communication_list' %}" style=" color: #95969D;">소통 게시판</a>
        </div>
        <div class="nav-right">
            <a href="{% url 'accounts:profile' %}">
                <img class="nav-icon-third" style="margin-right: 15px;" src="{{request.user.profile.image}}" alt="">
            </a>
            <p style="color: #FFFFFF;top:50%;margin-bottom: 0px; margin-right:30px;
            color: var(--unnamed, #F6F7FB);
            font-size: 16px;
            font-style: normal;
            font-weight: 700;
            line-height: normal;">{{ request.user.profile.name }}님</p>
            <a href="{% url 'accounts:logOut' %}" style="text-decoration: none;
            color: inherit;">
            <p style="color: #FFFFFF;top:50%;margin-bottom: 0px; margin-right:40px;
            color: var(--1, #95969D);
            font-size: 16px;
            font-style: normal;
            font-weight: 700;
            line-height: normal;">로그아웃</p>
            </a>
        </div>
    </nav>

    <!-- header -->
    <!-- copy -->
    <header class="study-title">
        <p>어른이 되기 위한 우리의</p>       
        <p>오늘의 공부</p>
    </header>

    <!-- nav2 -->
    <!-- copy -->
    <nav id="nav2">
        <p id="nav2-first">프 로 필</p>
    </nav>

    <!-- main-scroll-icon -->
    <div class="main-scroll-icon">
        <img src="{% static 'img/main-scroll-icon.png' %}" alt="Scroll Icon">
    </div>

    <div class="edit-user-info-container">
        <div class="text-box">
            
            <img src="{% static 'img/profile-logo.png' %}" alt="">
            <div style="display: flex; flex-direction: row;">
                <p class="text-highlight">후배</p>
                <p>님의 서비스에 이용되는&nbsp;</p>
                <p class="text-highlight">프로필</p>
                <p>을 작성해주세요.</p>
            </div>
        </div>
        <div id="user-basic-info">
            <p class="user-info-title">기본 정보</p>
            <div id="user-name">
                <p class="user-info-title">이름</p>
                    <input style="padding-left: 44px;" type="text" placeholder="{{request.user.profile.name}}">
            </div>
            <div id="user-introduce">
                <p class="user-info-title">한 줄 소개</p>
                <form action="" method="post">
                    <input style="padding-left: 44px;" type="textarea" placeholder="{{request.user.profile.description}}">
                </form>
            </div>
        </div>
        <div id="user-img">
            <p class="user-info-title">프로필 사진</p>
            <div id="user-img-box">
                <img src="{{request.user.profile.image.url}}" alt="">
            </div>
        </div>
        <button class="edit-please" style="background-color: #17181A; 
        color: #F6F7FB;
        width: fit-content;
        height: 90px;
        font-size: 24px;
        padding: 30px;
        border: none;
        border-radius: 45px;
        margin-top: 80px;
        margin-bottom: 40px;">수정하기</button>
        <div class="edit-user-boxx" style="border: 0px solid #95969D;
        padding-left: 40px;
        padding-right: 40px;
        margin-top: 30px;
        margin-bottom: 40px;
        border-radius: 40px;
        background-color: rgba(128, 128, 128, 0.1);">
        <form action="{}" method="post">
            <div id="user-name">
                <p class="user-info-title">이름</p>
                    <input style="padding-left: 44px;" type="text" placeholder="{{request.user.profile.name}}">
            </div>
            <div id="user-introduce">
                <p class="user-info-title">한 줄 소개</p>
                    <input style="padding-left: 44px;" type="textarea" placeholder="{{request.user.profile.description}}">
            </div>
            <div class="text-box">
                <p class="box-title">이미지 업로드</p>
                <div class="img"></div>
                    <div class="button" style="width: 180px;
                    text-align: center;
                    height: 70px;
                    background-color: #FF5B16;
                    color: #EBECF0;
                    border-radius: 45px;
                    padding: 20px;
                    cursor: pointer;
                    font-size: 17px;">
                        <label for="chooseFile">
                            이미지 업로드 버튼
                        </label>
                    </div>
                    <input class="imgUploadTag" type="file" id="chooseFile" name="answerImage" accept="image/*" onchange="loadFile(this)">
            </div> 
            <div style="margin-bottom: 30px; text-align: center;">
                <input style="background-color: #FF5B16; 
                color: #F6F7FB;
                width: fit-content;
                height: 90px;
                font-size: 24px;
                padding: 30px;
                border: none;
                border-radius: 45px;" class="edit-complete" type="submit" value="수정완료">
            </div>
        </form>
            
        </div>
    </div>
    <hr>
    <div id="user-quiz-grade">
        <div class="text-box">
            <img src="{% static 'img/profile-logo.png' %}" alt="">
            <div style="display: flex; flex-direction: row;">
                <p class="text-highlight">후배</p>
                <p>님의 서비스에 이용되는&nbsp;</p>
                <p class="text-highlight">프로필</p>
                <p>을 작성해주세요.</p>
            </div>
        </div>
        <div id="user-quiz-container">
            <div style="width: 700px;height: 100%;">
                <div class="score-box">
                    <div class="score-box-nav">
                        <p id="nav-all-score">전체 점수</p>
                        <p id="nav-not-all-score" >항목별 점수</p>
                    </div>
                    <div class="score-graph" id="all-score">
                        <div class="score-graph-count">
                            <p>9</p>
                            <p>8</p>
                            <p>7</p>
                            <p>6</p>
                            <p>5</p>
                            <p>4</p>
                            <p>3</p>
                            <p>2</p>
                            <p>1</p>
                            <p>0</p>
                        </div>
                        <div class="score-graph-view-box">
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="all-score-body" >
                                </div>
                                <div class="score-graph-date" id="score-graph-date-first">
                                    <p></p>
                                    <p>/</p>
                                    <p></p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="all-score-body">
                                </div>
                                <div class="score-graph-date" id="score-graph-date-second">
                                    <p></p>
                                    <p>/</p>
                                    <p></p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="all-score-body">
                                </div>
                                <div class="score-graph-date" id="score-graph-date-third">
                                    <p></p>
                                    <p>/</p>
                                    <p></p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="all-score-body">
                                </div>
                                <div class="score-graph-date" id="score-graph-date-fourth">
                                    <p></p>
                                    <p>/</p>
                                    <p></p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="all-score-body">
                                </div>
                                <div class="score-graph-date" id="score-graph-date-fifth">
                                    <p></p>
                                    <p>/</p>
                                    <p></p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="all-score-body">
                                </div>
                                <div class="score-graph-date" id="score-graph-date-sixth">
                                    <p></p>
                                    <p>/</p>
                                    <p></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="score-graph" id="not-all-score">
                        <div class="score-graph-count">
                            <p>100</p>
                            <p>80</p>
                            <p>60</p>
                            <p>40</p>
                            <p>20</p>
                            <p>0</p>
                        </div>
                        <div class="score-graph-view-box">
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="not-all-score-body">
                                </div>
                                <div class="score-graph-date">
                                    <p>전체</p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="not-all-score-body">
                                </div>
                                <div class="score-graph-date">
                                    <p>부동산</p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="not-all-score-body">
                                </div>
                                <div class="score-graph-date">
                                    <p>경제</p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="not-all-score-body">
                                </div>
                                <div class="score-graph-date">
                                    <p>트렌드</p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="not-all-score-body">
                                </div>
                                <div class="score-graph-date" style="text-align: center;">
                                    <p>할인</p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="not-all-score-body">
                                </div>
                                <div class="score-graph-date">
                                    <p>시사</p>
                                </div>
                            </div>
                            <div class="score-graph-view">
                                <div class="score-graph-body" id="not-all-score-body">
                                </div>
                                <div class="score-graph-date">
                                    <p>기타</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="user-last-week">
                <p class="text-highlight" style="margin-top: 50px; text-align: center; font-size: 24px;">지난주 공부</p>
                <div class="user-last-week-content-box" style=" margin-top: 100px; margin-bottom: 70px;">
                    <div class="user-last-week-content">
                        <p>공부</p>
                        <p>3개</p>
                    </div>
                    <div class="user-last-week-content">
                        <p>공부</p>
                        <p>3개</p>
                    </div>
                </div> 
                <div class="user-last-week-content-box">
                    <div class="user-last-week-content">
                        <p>공부</p>
                        <p>3개</p>
                    </div>
                    <div class="user-last-week-content">
                        <p>공부</p>
                        <p>3개</p>
                    </div>
                </div> 
            </div>
        </div>
    </div>
    <hr>
    <div id="user-level-container">
        <div class="text-box">
            <img src="{% static 'img/profile-logo.png' %}" alt="">
            <div style="display: flex; flex-direction: row;">
                <p class="text-highlight">부기 후배</p>
                <p>님의 답변에&nbsp;</p>
                <p class="text-highlight">86%의 후배들이 만족</p>
                <p>했어요!</p>
            </div>
        </div>
        <div id="user-level-boxs">
            <div class="user-level-box">
                <p style="color: #17181A;
                text-align: center;
                font-family: NanumGothic;
                font-size: 24px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;
                letter-spacing: 2.4px;
                margin-bottom: 20px;"
                >답변한 횟수</p>
                <div class="user-level-box-num">
                    <p style="color: #000;
                    text-align: center;
                    font-family: NanumGothic;
                    font-size: 64px;
                    font-style: normal;
                    font-weight: 700;
                    line-height: normal;
                    display: flex;
                    align-items: end;"
                    >{{answerCount}}</p>
                    <p style="color: #95969D;
                    text-align: center;
                    font-family: NanumGothic;
                    font-size: 24px;
                    font-style: normal;
                    font-weight: 700;
                    line-height: normal;
                    display: flex;
                    align-items: end;"
                    >/</p>
                    <p style="color: #95969D;
                    text-align: center;
                    font-family: NanumGothic;
                    font-size: 24px;
                    font-style: normal;
                    font-weight: 700;
                    line-height: normal;
                    display: flex;
                    align-items: end;"
                    >2000</p>
                </div>
            </div>
            <div class="user-level-box">
                <p style="color: #17181A;
                text-align: center;
                font-family: NanumGothic;
                font-size: 24px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;
                letter-spacing: 2.4px;
                margin-bottom: 20px;"
                >답변 추천 횟수</p>
                <div class="user-level-box-num">
                    <p style="color: #FF5B16;
                    text-align: center;
                    font-family: NanumGothic;
                    font-size: 64px;
                    font-style: normal;
                    font-weight: 700;
                    line-height: normal;"
                    >{{answerRecommendCount}}</p>
                    <p style="color: #95969D;
                    text-align: center;
                    font-family: NanumGothic;
                    font-size: 24px;
                    font-style: normal;
                    font-weight: 700;
                    line-height: normal;
                    display: flex;
                    align-items: end;"
                    >/</p>
                    <p style="color: #95969D;
                    text-align: center;
                    font-family: NanumGothic;
                    font-size: 24px;
                    font-style: normal;
                    font-weight: 700;
                    line-height: normal;
                    display: flex;
                    align-items: end;"
                    >2000</p>
                </div>
            </div>
            <div class="user-level-box">
                <p style="color: #17181A;
                text-align: center;
                font-family: NanumGothic;
                font-size: 24px;
                font-style: normal;
                font-weight: 700;
                line-height: normal;
                letter-spacing: 2.4px;
                margin-bottom: 20px;"
                >질문한 횟수</p>
                <div class="user-level-box-num">
                    <p style="color: #FF5B16;
                    text-align: center;
                    font-family: NanumGothic;
                    font-size: 64px;
                    font-style: normal;
                    font-weight: 700;
                    line-height: normal;"
                    >{{questionCount}}</p>
                </div>
            </div>
        </div>
        <div id="user-progress-bar-container" style="margin: 0 auto;">
            <div class="speech-bubble">
                <div class="speech-bubble-text" >
                    <p class="text-highlight" style="margin-bottom: 0px;">답변 1880회 / 추천 2660회&nbsp;</p>
                    <p style="color: #17181A;margin-bottom: 0px;">채우면 인생 선배가 될 수 있어요!</p>
                </div>
                <span class="arrow"></span>
            </div>                           
            <div class="progress" style="margin-left: 15px; margin-right: 15px;" role="progressbar" aria-label="Example 50px high" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="height: 50px">
                <div class="progress-bar" style="background-color: #FF5B16;  width:75%;"></div>
            </div>
            <div id="user-progress-bar-container-text">
                <p>인생 후배</p>
                <p>인생 선배</p>
            </div>
        </div>
    </div>
    <div id="test" name={{ correctQuizCount }}></div>
    <div id="category" name={{ index }}></div>
    <!-- footer -->
    <footer>
        <img src="{% static 'img/footer.png' %}" alt="">
    </footer>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="{% static 'js/scroll.js' %}"></script>
    <script src="{% static 'js/graphJs.js' %}"></script>
    <script src="{% static 'js/profileJs.js' %}"></script>
    <script src="{% static 'js/dateJs.js' %}"></script>
    <script>
    $(document).ready(function() {
        var progressBarWidth = $(".progress-bar").width();
        var speechBubbleWidth = $(".speech-bubble").width();
        var offset = (progressBarWidth - (speechBubbleWidth/2)+13);

        $(".speech-bubble").css("left", offset);
    });
    </script>
    <script>
        function loadFile(input) {
          var file = input.files[0];
          var name = document.getElementById('fileName');
          name.textContent = file.name;
        
          var newImage = document.createElement("img");
          newImage.setAttribute("class", 'img');
          newImage.src = URL.createObjectURL(file);
          newImage.style.width = "70%";
          newImage.style.height = "70%";
          newImage.style.visibility = "hidden";
          newImage.style.objectFit = "contain";
        
          var container = document.getElementById('image-show');
          container.appendChild(newImage);
        }
        
        var submit = document.querySelector('button[type="submit"]');
        submit.onclick = function(event) {
          event.preventDefault();
        
          var input = document.getElementById('chooseFile');
          var file = input.files[0];
        
          if (file) {
            var formData = new FormData();
            formData.append('answerImage', file);
            formData.append('content', document.querySelector('textarea[name="content"]').value);
            formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');
        
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '{% url "communicationApp:answer_create" question.id %}');
            xhr.onload = function() {
              if (xhr.status === 200) {
                // 서버 응답이 성공적으로 도착한 경우 처리할 로직 작성
              }
            };
            xhr.send(formData);
          }
        };
        </script>
</body>
</html>