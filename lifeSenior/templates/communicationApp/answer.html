{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/communicationStyle.css' %}">
    <link rel="stylesheet" href="{% static 'css/default.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js" integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS" crossorigin="anonymous"></script>
    <title>lifesenior</title>
</head>
<body>
    <!-- nav bar -->
    <!-- copy -->
    <nav>
        <div class="nav-left">
            <img src="{% static 'img/main-nav-logo.png' %}" alt="로고">
            <a href="{% url 'main' %}" style="color: #95969D;">홈</a>
            <a style=" color: #95969D;" href="{% url 'quizApp:studySpace' level=0 %}">오늘의 공부</a>
            <a style=" color: #FFFFFF;" href="{% url 'communicationApp:communication_list' %}">소통 게시판</a>
        </div>
        <div class="nav-right">
            <a href="{% url 'accounts:profile' %}">
                <img class="nav-icon-third" style="margin-right: 15px;" src="{{request.user.profile.image.url}}" alt="">
            </a>
            <p style="color: #FFFFFF;top:50%;margin-bottom: 0px; margin-right:30px;
            color: var(--unnamed, #F6F7FB);
            font-size: 16px;
            font-style: normal;
            font-weight: 700;
            line-height: normal;">{{request.user.profile.name}}님</p>
            <a href="{% url 'accounts:logOut' %}" style="text-decoration: none;
            color: inherit;">
            <p style="color: #FFFFFF;top:50%;margin-bottom: 0px; margin-right:40px;
            color: var(--1, #95969D);
            font-size: 16px;
            font-style: normal;
            font-weight: 700;
            line-height: normal;">로그아웃</p>
            </a>
        </div>
    </nav>

        <!-- header -->
    <!-- copy -->
    <header class="study-title">
        <p>어른이 되기 위한 우리의</p>       
        <p>소통게시판</p>
    </header>
    <!-- header end -->

    <!-- nav2 -->
    <nav id="nav2">
        <a href="{% url 'communicationApp:question_create' %}" style="text-decoration: none;
        color: inherit;margin-right: 84px;"><p id="nav2-first" style="color:#95969D;">질문하기</p></a>
        <a href="{% url 'communicationApp:my_question' %}" style="text-decoration: none;
        color: inherit;margin-right: 84px;"><p id="nav2-second">내가 한 질문</p></a>
        <a href="{% url 'communicationApp:answer_list' %}" style="text-decoration: none;
        color: inherit;color: #FFFFFF;"><p>답변하기</p></a>
    </nav>

    <!-- main-scroll-icon -->
    <!-- copy -->
    <div class="main-scroll-icon">
        <img src="{% static 'img/main-scroll-icon.png' %}" alt="Scroll Icon">
    </div>
    <!-- main-scroll-icon end -->

    <!-- main-container -->
    <div id="main-container">
       <div class="container-community">
        <img id="container-community-logo-img" src="{% static 'img/main-nav-logo.png' %}" alt="">
        <p id="container-community-first-p">인생선배에서 배운 내용으로</p>
        <p id="container-community-second-p">다른후배들에게 답변을 해보세요!</p>
        <div class="container-community-btn-box">
            <div class="container-community-btn">
               <!-- <input type="submit" value="대출"> -->
               <input type="submit" value="부동산" id="one">
               <input type="submit" value="경제" id="two">
               <input type="submit" value="트렌드" id="three">
               <input type="submit" value="할인" id="four">
               <input type="submit" value="시사상식" id="five">
               <!-- <input type="submit" value="자취 및 생활방식">
               <input type="submit" value="여행">
               <input type="submit" value="제태크">
               <input type="submit" value="계약">
               <input type="submit" value="취미">
               <input type="submit" value="자격증">
               <input type="submit" value="대학">
               <input type="submit" value="취직">
               <input type="submit" value="대출"> -->
               <input type="submit" value="기타" id="six">
            </div>
            <div class="btn-group">
                <button type="button" class="btn dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    최신순
                </button>
                <ul class="dropdown-menu" style="text-align: center;">
                    <li><a class="dropdown-item" href="#" id="list-one">최신순</a></li>
                    <li><a class="dropdown-item" href="#" id="list-two">추천순</a></li>
                    <li><a class="dropdown-item" href="#" id="list-three">조회순</a></li>
                    <li><a class="dropdown-item" href="#" id="list-four">답변완료순</a></li>
                    <!-- <li><a class="dropdown-item" href="#" id="list-five">답변없는순</a></li> -->
                </ul>
            </div>
        </div>
        <a id='question'>
            
        </a>
    </div>

    <!-- footer -->
    <footer>
        <img src="{% static 'img/footer.png' %}" alt="">
    </footer>
    
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script type="text/javascript">
        var clickedIds = [];
        var oneCount =0;
        var twoCount =0;
        var threeCount =0;
        var fourCount =0;
        var fiveCount =0;
        var sixCount =0;
        var oneNum = 1;
        var twoNum =2;
        var threeNum =3;
        var fourNum =4;
        var fiveNum =5;
        var sixNum =6;
        var sort ="date";
        $("#list-one").click(function(){
            sort="date";
        });
        $("#list-two").click(function(){
            sort="likes";
        });
        $("#list-three").click(function(){
            sort="views";
        });
        $("#list-four").click(function(){
            sort="answerd";
        });
        $("#list-five").click(function(){
            sort="notAnswerd";
        });
        $("#one").click(function(){
            oneCount++;
            if(oneCount==1){
                clickedIds.push(oneNum);
                $("#one").css("color","#F6F7FB");
                $("#one").css("background-color","#17181A");
            }else if(oneCount==2){
                clickedIds = clickedIds.filter(function(number) {
                    return number !== oneNum;
                });
                oneCount=0;
                $("#one").css("color","#95969D");
                $("#one").css("background-color","#EBECF0");
            }
            $.ajax({ // .like 버튼을 클릭하면 <새로고침> 없이 ajax로 서버와 통신하겠다.
                type: "POST", // 데이터를 전송하는 방법을 지정
                url: "{% url 'communicationApp:getAnswerList' %}", // 통신할 url을 지정
                data: {'array': clickedIds,'sort':sort,'csrfmiddlewaretoken': '{{ csrf_token }}'},
                dataType: "text", 
                success: function(response){ // 통신 성공시 - 동적으로 좋아요 갯수 변경, 유저 목록 변경
                    $("#question").html(response);
                    console.log("success")
                },
                error: function(request, status, error){ // 통신 실패시 - 로그인 페이지 리다이렉트  
                    console.log("fail")
                },
            });
            console.log(sort);
            console.log(clickedIds);
        });
        $("#two").click(function(){
            twoCount++;
            if(twoCount==1){
                clickedIds.push(twoNum);
                $("#two").css("color","#F6F7FB");
                $("#two").css("background-color","#17181A");
            }else if(twoCount==2){
                clickedIds = clickedIds.filter(function(number) {
                    return number !== twoNum;
                });
                twoCount=0;
                $("#two").css("color","#95969D");
                $("#two").css("background-color","#EBECF0");
            }
            $.ajax({ // .like 버튼을 클릭하면 <새로고침> 없이 ajax로 서버와 통신하겠다.
                type: "POST", // 데이터를 전송하는 방법을 지정
                url: "{% url 'communicationApp:getAnswerList' %}", // 통신할 url을 지정
                data: {'array': clickedIds,'sort':sort,'csrfmiddlewaretoken': '{{ csrf_token }}'},
                dataType: "text", 
                success: function(response){ // 통신 성공시 - 동적으로 좋아요 갯수 변경, 유저 목록 변경
                    $("#question").html(response);
                    console.log("success")
                },
                error: function(request, status, error){ // 통신 실패시 - 로그인 페이지 리다이렉트  
                    console.log("fail")
                },
            });
            console.log(sort);
            console.log(clickedIds);
        });

        $("#three").click(function(){
            threeCount++;
            if(threeCount==1){
                clickedIds.push(threeNum);
                $("#three").css("color","#F6F7FB");
                $("#three").css("background-color","#17181A");
            }else if(threeCount==2){
                clickedIds = clickedIds.filter(function(number) {
                    return number !== threeNum;
                });
                threeCount=0;
                $("#three").css("color","#95969D");
                $("#three").css("background-color","#EBECF0");
            }
            $.ajax({ // .like 버튼을 클릭하면 <새로고침> 없이 ajax로 서버와 통신하겠다.
                type: "POST", // 데이터를 전송하는 방법을 지정
                url: "{% url 'communicationApp:getAnswerList' %}", // 통신할 url을 지정
                data: {'array': clickedIds,'sort':sort,'csrfmiddlewaretoken': '{{ csrf_token }}'},
                dataType: "text", 
                success: function(response){ // 통신 성공시 - 동적으로 좋아요 갯수 변경, 유저 목록 변경
                    $("#question").html(response);
                    console.log("success")
                },
                error: function(request, status, error){ // 통신 실패시 - 로그인 페이지 리다이렉트  
                    console.log("fail")
                },
            });
            console.log(sort);
            console.log(clickedIds);
        });
        $("#four").click(function(){
            fourCount++;
            if(fourCount==1){
                clickedIds.push(fourNum);
                $("#four").css("color","#F6F7FB");
                $("#four").css("background-color","#17181A");
            }else if(fourCount==2){
                clickedIds = clickedIds.filter(function(number) {
                    return number !== fourNum;
                });
                fourCount=0;
                $("#four").css("color","#95969D");
                $("#four").css("background-color","#EBECF0");
            }
            $.ajax({ // .like 버튼을 클릭하면 <새로고침> 없이 ajax로 서버와 통신하겠다.
                type: "POST", // 데이터를 전송하는 방법을 지정
                url: "{% url 'communicationApp:getAnswerList' %}", // 통신할 url을 지정
                data: {'array': clickedIds,'sort':sort,'csrfmiddlewaretoken': '{{ csrf_token }}'},
                dataType: "text", 
                success: function(response){ // 통신 성공시 - 동적으로 좋아요 갯수 변경, 유저 목록 변경
                    $("#question").html(response);
                    console.log("success")
                },
                error: function(request, status, error){ // 통신 실패시 - 로그인 페이지 리다이렉트  
                    console.log("fail")
                },
            });
            console.log(sort);
            console.log(clickedIds);
        });
        $("#five").click(function(){
            fiveCount++;
            if(fiveCount==1){
                clickedIds.push(fiveNum);
                $("#five").css("color","#F6F7FB");
                $("#five").css("background-color","#17181A");
            }else if(fiveCount==2){
                clickedIds = clickedIds.filter(function(number) {
                    return number !== fiveNum;
                });
                fiveCount=0;
                $("#five").css("color","#95969D");
                $("#five").css("background-color","#EBECF0");
            }
            $.ajax({ // .like 버튼을 클릭하면 <새로고침> 없이 ajax로 서버와 통신하겠다.
                type: "POST", // 데이터를 전송하는 방법을 지정
                url: "{% url 'communicationApp:getAnswerList' %}", // 통신할 url을 지정
                data: {'array': clickedIds,'sort':sort,'csrfmiddlewaretoken': '{{ csrf_token }}'},
                dataType: "text", 
                success: function(response){ // 통신 성공시 - 동적으로 좋아요 갯수 변경, 유저 목록 변경
                    $("#question").html(response);
                    console.log("success")
                },
                error: function(request, status, error){ // 통신 실패시 - 로그인 페이지 리다이렉트  
                    console.log("fail")
                },
            });
            console.log(sort);
            console.log(clickedIds);
        });
        $("#six").click(function(){
            sixCount++;
            if(sixCount==1){
                clickedIds.push(sixNum);
                $("#six").css("color","#F6F7FB");
                $("#six").css("background-color","#17181A");
            }else if(sixCount==2){
                clickedIds = clickedIds.filter(function(number) {
                    return number !== sixNum;
                });
                sixCount=0;
                $("#six").css("color","#95969D");
                $("#six").css("background-color","#EBECF0");
            }
            $.ajax({ // .like 버튼을 클릭하면 <새로고침> 없이 ajax로 서버와 통신하겠다.
                type: "POST", // 데이터를 전송하는 방법을 지정
                url: "{% url 'communicationApp:getAnswerList' %}", // 통신할 url을 지정
                data: {'array': clickedIds,'sort':sort,'csrfmiddlewaretoken': '{{ csrf_token }}'},
                dataType: "text", 
                success: function(response){ // 통신 성공시 - 동적으로 좋아요 갯수 변경, 유저 목록 변경
                    $("#question").html(response);
                    console.log("success")
                },
                error: function(request, status, error){ // 통신 실패시 - 로그인 페이지 리다이렉트  
                    console.log("fail")
                },
            });
            console.log(sort);
            console.log(clickedIds);
        });
    </script>
    
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="{% static 'js/scroll.js' %}"></script>
    <script src="{% static 'js/mainJs.js' %}"></script>
</body>
</html>